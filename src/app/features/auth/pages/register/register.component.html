<div
  class="min-h-screen w-full font-serif relative overflow-hidden"
  style="background-color: #100820; color: #b4a2fd"
>
  <!-- Animated Stars Background -->
  <div class="fixed inset-0 pointer-events-none z-0">
    <!-- Large Stars -->
    <div
      class="star large"
      style="top: 5%; left: 10%; animation-delay: 0s"
    ></div>
    <div
      class="star large"
      style="top: 12%; left: 85%; animation-delay: 1.4s"
    ></div>
    <div
      class="star large"
      style="top: 28%; left: 7%; animation-delay: 2.3s"
    ></div>
    <div
      class="star large"
      style="top: 42%; left: 88%; animation-delay: 1.7s"
    ></div>
    <div
      class="star large"
      style="top: 58%; left: 12%; animation-delay: 3.1s"
    ></div>
    <div
      class="star large"
      style="top: 73%; left: 90%; animation-delay: 1.2s"
    ></div>
    <div
      class="star large"
      style="top: 87%; left: 18%; animation-delay: 0.8s"
    ></div>
    <div
      class="star large"
      style="top: 95%; left: 75%; animation-delay: 2.6s"
    ></div>

    <!-- Medium Stars -->
    <div
      class="star medium"
      style="top: 8%; left: 42%; animation-delay: 0.6s"
    ></div>
    <div
      class="star medium"
      style="top: 16%; left: 62%; animation-delay: 2.4s"
    ></div>
    <div
      class="star medium"
      style="top: 25%; left: 28%; animation-delay: 1.3s"
    ></div>
    <div
      class="star medium"
      style="top: 35%; left: 68%; animation-delay: 2.9s"
    ></div>
    <div
      class="star medium"
      style="top: 45%; left: 33%; animation-delay: 0.7s"
    ></div>
    <div
      class="star medium"
      style="top: 52%; left: 78%; animation-delay: 2.2s"
    ></div>
    <div
      class="star medium"
      style="top: 65%; left: 25%; animation-delay: 1.6s"
    ></div>
    <div
      class="star medium"
      style="top: 75%; left: 65%; animation-delay: 2.8s"
    ></div>
    <div
      class="star medium"
      style="top: 82%; left: 45%; animation-delay: 0.4s"
    ></div>
    <div
      class="star medium"
      style="top: 92%; left: 55%; animation-delay: 2.1s"
    ></div>

    <!-- Small Stars -->
    <div
      class="star small"
      style="top: 3%; left: 25%; animation-delay: 1.1s"
    ></div>
    <div
      class="star small"
      style="top: 18%; left: 78%; animation-delay: 2.7s"
    ></div>
    <div
      class="star small"
      style="top: 38%; left: 8%; animation-delay: 0.5s"
    ></div>
    <div
      class="star small"
      style="top: 48%; left: 92%; animation-delay: 1.9s"
    ></div>
    <div
      class="star small"
      style="top: 68%; left: 15%; animation-delay: 2.5s"
    ></div>
    <div
      class="star small"
      style="top: 78%; left: 85%; animation-delay: 1s"
    ></div>
    <div
      class="star small"
      style="top: 88%; left: 35%; animation-delay: 2.3s"
    ></div>

    <!-- Sparkles -->
    <div
      class="sparkle"
      style="top: 14%; left: 52%; animation-delay: 0.8s"
    ></div>
    <div
      class="sparkle"
      style="top: 22%; left: 12%; animation-delay: 1.7s"
    ></div>
    <div
      class="sparkle"
      style="top: 32%; left: 82%; animation-delay: 2.6s"
    ></div>
    <div
      class="sparkle"
      style="top: 54%; left: 42%; animation-delay: 1.3s"
    ></div>
    <div
      class="sparkle"
      style="top: 72%; left: 72%; animation-delay: 2.9s"
    ></div>
    <div
      class="sparkle"
      style="top: 85%; left: 28%; animation-delay: 0.6s"
    ></div>

    <!-- Floating sparkles -->
    <div
      class="floating-sparkle"
      style="top: 20%; left: 65%; animation-delay: 1.4s"
    ></div>
    <div
      class="floating-sparkle"
      style="top: 40%; left: 38%; animation-delay: 2.8s"
    ></div>
    <div
      class="floating-sparkle"
      style="top: 60%; left: 78%; animation-delay: 0.9s"
    ></div>
    <div
      class="floating-sparkle"
      style="top: 80%; left: 22%; animation-delay: 2.2s"
    ></div>
  </div>

  <!-- Mystical Gradient Overlay -->
  <div class="fixed inset-0 pointer-events-none z-1">
    <div class="mystical-gradient"></div>
  </div>

  <!-- Content -->
  <div class="min-h-screen flex items-center justify-center p-4 relative z-10">
    <!-- Back to Home Button -->
    <div class="absolute top-6 left-6 z-20">
      <button
        class="back-home-btn group"
        (click)="onBackToHome()"
        type="button"
        aria-label="Volver al inicio"
      >
        <i
          class="fas fa-arrow-left mr-2 transition-transform group-hover:-translate-x-1"
        ></i>
        <span class="hidden sm:inline">Volver al Inicio</span>
        <span class="sm:hidden">Inicio</span>
      </button>
    </div>

    <!-- Register Container -->
    <div class="register-container">
      <!-- Header Section -->
      <div class="register-header" *ngIf="!showEmailVerification()">
        <!-- Mystical Icon Container - TRANSFORMADO CON STAR-OF-LIFE -->
        <div class="register-icon-container">
          <div class="mystical-starlife-wrapper">
            <i class="fas fa-star-of-life mystical-starlife-icon"></i>
            <div class="starlife-inner-glow"></div>
            <div class="starlife-outer-glow"></div>
            <div class="starlife-particles">
              <div class="particle particle-1"></div>
              <div class="particle particle-2"></div>
              <div class="particle particle-3"></div>
              <div class="particle particle-4"></div>
            </div>
          </div>

          <!-- Sparkle secundario - TRANSFORMADO -->
          <div class="icon-sparkle-professional">
            <i class="fas fa-sparkles sparkle-secondary"></i>
            <div class="sparkle-trail sparkle-trail-1"></div>
            <div class="sparkle-trail sparkle-trail-2"></div>
          </div>

          <!-- Icono secundario - TRANSFORMADO CON GEM MÍSTICO -->
          <div class="icon-secondary-professional">
            <div class="mystical-gem-mini">
              <i class="fas fa-gem gem-mini-icon"></i>
              <div class="gem-mini-glow"></div>
            </div>
          </div>
        </div>

        <!-- Title and Subtitle -->
        <h1 class="register-title">
          <span class="title-highlight">Únete</span> a la Magia
        </h1>
        <p class="register-subtitle">
          Comienza tu viaje de despertar espiritual y descubre tu verdadero
          potencial místico
        </p>
      </div>

      <!-- Register Form -->
      <form
        class="register-form"
        (ngSubmit)="onSubmit()"
        #registerForm="ngForm"
        novalidate
        (keydown)="onKeyDown($event)"
        *ngIf="!showEmailVerification()"
      >
        <!-- Personal Information Section -->
        <div class="form-section">
          <div class="section-header">
            <i class="fas fa-user-circle section-icon"></i>
            <h3 class="section-title">Información Personal</h3>
          </div>

          <!-- Name Fields Row -->
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="nombre">
                <i class="fas fa-user label-icon"></i>
                Nombre
              </label>
              <div class="input-container">
                <input
                  id="nombre"
                  name="nombre"
                  type="text"
                  class="form-input"
                  [class.error]="hasFieldError('nombre')"
                  [class.loading]="isLoading()"
                  placeholder="Tu nombre"
                  [value]="credentials().nombre"
                  (input)="onInputChange($event, 'nombre')"
                  (blur)="onFieldBlur('nombre')"
                  required
                  autocomplete="given-name"
                  spellcheck="false"
                />
                <div class="input-border"></div>
                <div class="input-glow"></div>
              </div>
              <div class="error-message" *ngIf="hasFieldError('nombre')">
                <i class="fas fa-exclamation-circle mr-2"></i>
                {{ getFieldError("nombre") }}
              </div>
            </div>

            <div class="form-group">
              <label class="form-label" for="apellido">
                <i class="fas fa-user label-icon"></i>
                Apellido
              </label>
              <div class="input-container">
                <input
                  id="apellido"
                  name="apellido"
                  type="text"
                  class="form-input"
                  [class.error]="hasFieldError('apellido')"
                  [class.loading]="isLoading()"
                  placeholder="Tu apellido"
                  [value]="credentials().apellido"
                  (input)="onInputChange($event, 'apellido')"
                  (blur)="onFieldBlur('apellido')"
                  required
                  autocomplete="family-name"
                  spellcheck="false"
                />
                <div class="input-border"></div>
                <div class="input-glow"></div>
              </div>
              <div class="error-message" *ngIf="hasFieldError('apellido')">
                <i class="fas fa-exclamation-circle mr-2"></i>
                {{ getFieldError("apellido") }}
              </div>
            </div>
          </div>

          <!-- Email Field -->
          <div class="form-group">
            <label class="form-label" for="email">
              <i class="fas fa-envelope label-icon"></i>
              Correo Electrónico
            </label>
            <div class="input-container">
              <input
                id="email"
                name="email"
                type="email"
                class="form-input"
                [class.error]="hasFieldError('email')"
                [class.loading]="isLoading()"
                placeholder="tu@email.com"
                [value]="credentials().email"
                (input)="onInputChange($event, 'email')"
                (blur)="onFieldBlur('email')"
                required
                autocomplete="email"
                spellcheck="false"
              />
              <div class="input-border"></div>
              <div class="input-glow"></div>
            </div>
            <div class="error-message" *ngIf="hasFieldError('email')">
              <i class="fas fa-exclamation-circle mr-2"></i>
              {{ getFieldError("email") }}
            </div>
          </div>
        </div>

        <!-- Spiritual Profile Section -->
        <div class="form-section">
          <div class="section-header">
            <i class="fas fa-star section-icon"></i>
            <h3 class="section-title">Tu Perfil Espiritual</h3>
          </div>

          <!-- Profile Type Selection - ICONOS TRANSFORMADOS -->
          <div class="form-group">
            <label class="form-label">
              <i class="fas fa-heart label-icon"></i>
              ¿Con qué tipo de persona te identificas?
            </label>
            <div class="radio-group-enhanced">
              <div
                class="radio-option-enhanced"
                (click)="onProfileSelect('espiritual')"
              >
                <input
                  type="radio"
                  name="tipoPerfil"
                  value="espiritual"
                  [checked]="credentials().tipoPerfil === 'espiritual'"
                  (change)="onProfileSelect('espiritual')"
                  style="display: none"
                />
                <div
                  class="radio-card"
                  [class.selected]="credentials().tipoPerfil === 'espiritual'"
                >
                  <!-- TRANSFORMADO: De 🧘‍♀️ a SPA PROFESIONAL -->
                  <div class="radio-icon-professional spiritual-seeker">
                    <div class="zen-meditation-wrapper">
                      <i class="fas fa-spa zen-icon"></i>
                      <div class="zen-inner-peace"></div>
                      <div class="zen-aura-ring ring-1"></div>
                      <div class="zen-aura-ring ring-2"></div>
                      <div class="zen-particles">
                        <div class="zen-particle zen-p-1"></div>
                        <div class="zen-particle zen-p-2"></div>
                        <div class="zen-particle zen-p-3"></div>
                      </div>
                    </div>
                  </div>
                  <div class="radio-content">
                    <span class="radio-title">Buscador Espiritual</span>
                    <span class="radio-description"
                      >Exploro mi crecimiento interior y busco paz mental</span
                    >
                  </div>
                  <div class="radio-check">
                    <i class="fas fa-check"></i>
                  </div>
                </div>
              </div>

              <div
                class="radio-option-enhanced"
                (click)="onProfileSelect('esoterico')"
              >
                <input
                  type="radio"
                  name="tipoPerfil"
                  value="esoterico"
                  [checked]="credentials().tipoPerfil === 'esoterico'"
                  (change)="onProfileSelect('esoterico')"
                  style="display: none"
                />
                <div
                  class="radio-card"
                  [class.selected]="credentials().tipoPerfil === 'esoterico'"
                >
                  <!-- TRANSFORMADO: De 🔮 a GEM PROFESIONAL -->
                  <div class="radio-icon-professional esoteric-practitioner">
                    <div class="mystical-crystal-wrapper-radio">
                      <i class="fas fa-gem crystal-radio-icon"></i>
                      <div class="crystal-radio-inner-glow"></div>
                      <div class="crystal-radio-outer-glow"></div>
                      <div class="crystal-radio-particles">
                        <div class="crystal-particle c-p-1"></div>
                        <div class="crystal-particle c-p-2"></div>
                        <div class="crystal-particle c-p-3"></div>
                      </div>
                    </div>
                  </div>
                  <div class="radio-content">
                    <span class="radio-title">Practicante Esotérico</span>
                    <span class="radio-description"
                      >Practico artes místicas y estudio el ocultismo</span
                    >
                  </div>
                  <div class="radio-check">
                    <i class="fas fa-check"></i>
                  </div>
                </div>
              </div>

              <div
                class="radio-option-enhanced"
                (click)="onProfileSelect('ambos')"
              >
                <input
                  type="radio"
                  name="tipoPerfil"
                  value="ambos"
                  [checked]="credentials().tipoPerfil === 'ambos'"
                  (change)="onProfileSelect('ambos')"
                  style="display: none"
                />
                <div
                  class="radio-card"
                  [class.selected]="credentials().tipoPerfil === 'ambos'"
                >
                  <!-- TRANSFORMADO: De 🌟 a STAR-OF-LIFE PROFESIONAL -->
                  <div class="radio-icon-professional balanced-seeker">
                    <div class="balanced-star-wrapper">
                      <i class="fas fa-star-of-life balanced-star-icon"></i>
                      <div class="balanced-inner-light"></div>
                      <div class="balanced-energy-rings">
                        <div class="energy-ring e-ring-1"></div>
                        <div class="energy-ring e-ring-2"></div>
                      </div>
                      <div class="balanced-sparkles">
                        <div class="balanced-sparkle b-s-1"></div>
                        <div class="balanced-sparkle b-s-2"></div>
                        <div class="balanced-sparkle b-s-3"></div>
                        <div class="balanced-sparkle b-s-4"></div>
                      </div>
                    </div>
                  </div>
                  <div class="radio-content">
                    <span class="radio-title">Ambos</span>
                    <span class="radio-description"
                      >Combino crecimiento espiritual con prácticas
                      esotéricas</span
                    >
                  </div>
                  <div class="radio-check">
                    <i class="fas fa-check"></i>
                  </div>
                </div>
              </div>
            </div>
            <div class="field-hint">
              <!-- TRANSFORMADO: De 💡 a LIGHTBULB PROFESIONAL -->
              <div class="hint-lightbulb-wrapper">
                <i class="fas fa-lightbulb hint-bulb-icon"></i>
                <div class="bulb-glow-hint"></div>
                <div class="bulb-spark-hint"></div>
              </div>
              <strong>Nota:</strong> <br />&nbsp;La opción que selecciones
              determinará el contenido que se te mostrará
            </div>
            <div class="error-message" *ngIf="hasFieldError('tipoPerfil')">
              <i class="fas fa-exclamation-circle mr-2"></i>
              {{ getFieldError("tipoPerfil") }}
            </div>
          </div>

          <!-- Birth Date (Optional) -->
          <div class="form-group">
            <label class="form-label" for="fechaNacimiento">
              <i class="fas fa-calendar-alt label-icon"></i>
              Fecha de Nacimiento
              <span class="optional-badge">Opcional</span>
            </label>
            <div class="input-container">
              <input
                id="fechaNacimiento"
                name="fechaNacimiento"
                type="date"
                class="form-input"
                [value]="credentials().fechaNacimiento"
                (input)="onInputChange($event, 'fechaNacimiento')"
                autocomplete="bday"
              />
              <div class="input-border"></div>
              <div class="input-glow"></div>
            </div>
            <div class="field-hint">
              <i class="fas fa-info-circle mr-2"></i>
              Nos ayudará a calcular tu signo zodiacal y personalizar tu
              experiencia
            </div>
            <!-- Zodiac Sign Display -->
            <div
              class="zodiac-display"
              *ngIf="calculatedZodiacSign() as zodiacSign"
            >
              <div class="zodiac-icon">{{ zodiacSign.icon }}</div>
              <span
                >Tu signo zodiacal es:
                <strong>{{ zodiacSign.name }}</strong></span
              >
            </div>
          </div>
        </div>

        <!-- Security Section -->
        <div class="form-section">
          <div class="section-header">
            <i class="fas fa-shield-alt section-icon"></i>
            <h3 class="section-title">Seguridad de tu Cuenta</h3>
          </div>

          <!-- Password Fields Row -->
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="password">
                <i class="fas fa-lock label-icon"></i>
                Contraseña
              </label>
              <div class="input-container">
                <input
                  id="password"
                  name="password"
                  [type]="showPassword() ? 'text' : 'password'"
                  class="form-input password-input"
                  [class.error]="hasFieldError('password')"
                  [class.loading]="isLoading()"
                  placeholder="••••••••"
                  [value]="credentials().password"
                  (input)="onInputChange($event, 'password')"
                  (blur)="onFieldBlur('password')"
                  required
                  minlength="6"
                  autocomplete="new-password"
                  spellcheck="false"
                />
                <button
                  type="button"
                  class="password-toggle"
                  (click)="togglePasswordVisibility('password')"
                  [attr.aria-label]="
                    showPassword() ? 'Ocultar contraseña' : 'Mostrar contraseña'
                  "
                  tabindex="-1"
                >
                  <i
                    [class]="showPassword() ? 'fas fa-eye-slash' : 'fas fa-eye'"
                  ></i>
                </button>
                <div class="input-border"></div>
                <div class="input-glow"></div>
              </div>
              <div class="error-message" *ngIf="hasFieldError('password')">
                <i class="fas fa-exclamation-circle mr-2"></i>
                {{ getFieldError("password") }}
              </div>
            </div>

            <div class="form-group">
              <label class="form-label" for="confirmPassword">
                <i class="fas fa-lock label-icon"></i>
                Confirmar Contraseña
              </label>
              <div class="input-container">
                <input
                  id="confirmPassword"
                  name="confirmPassword"
                  [type]="showConfirmPassword() ? 'text' : 'password'"
                  class="form-input password-input"
                  [class.error]="hasFieldError('confirmPassword')"
                  [class.loading]="isLoading()"
                  placeholder="••••••••"
                  [value]="credentials().confirmPassword"
                  (input)="onInputChange($event, 'confirmPassword')"
                  (blur)="onFieldBlur('confirmPassword')"
                  required
                  autocomplete="new-password"
                  spellcheck="false"
                />
                <button
                  type="button"
                  class="password-toggle"
                  (click)="togglePasswordVisibility('confirmPassword')"
                  [attr.aria-label]="
                    showConfirmPassword()
                      ? 'Ocultar contraseña'
                      : 'Mostrar contraseña'
                  "
                  tabindex="-1"
                >
                  <i
                    [class]="
                      showConfirmPassword() ? 'fas fa-eye-slash' : 'fas fa-eye'
                    "
                  ></i>
                </button>
                <div class="input-border"></div>
                <div class="input-glow"></div>
              </div>
              <div
                class="error-message"
                *ngIf="hasFieldError('confirmPassword')"
              >
                <i class="fas fa-exclamation-circle mr-2"></i>
                {{ getFieldError("confirmPassword") }}
              </div>
            </div>
          </div>

          <!-- Password Strength Indicator -->
          <div class="password-strength" *ngIf="credentials().password">
            <div class="strength-label">
              <i class="fas fa-key mr-2"></i>
              Seguridad de la contraseña
            </div>
            <div class="strength-bar">
              <div
                class="strength-fill"
                [class]="getPasswordStrengthClass()"
                [style.width.%]="passwordStrength().percentage"
              ></div>
            </div>
            <div class="strength-text">{{ getPasswordStrengthText() }}</div>
          </div>
        </div>

        <!-- Terms and Conditions Section -->
        <div class="form-section">
          <div class="section-header">
            <i class="fas fa-handshake section-icon"></i>
            <h3 class="section-title">Términos y Condiciones</h3>
          </div>

          <!-- Terms Checkbox -->
          <div class="form-group">
            <div
              class="checkbox-label-enhanced"
              (click)="
                onCheckboxChange('acceptTerms', !credentials().acceptTerms)
              "
            >
              <input
                type="checkbox"
                [checked]="credentials().acceptTerms"
                (change)="onCheckboxToggle($event, 'acceptTerms')"
                required
                style="display: none"
              />
              <span
                class="checkmark-enhanced"
                [class.checked]="credentials().acceptTerms"
              >
                <i class="fas fa-check"></i>
              </span>
              <div class="checkbox-content">
                <span class="checkbox-text">
                  Acepto los
                  <a href="#" class="link-mystical">términos y condiciones</a> y
                  la
                  <a href="#" class="link-mystical">política de privacidad</a>
                </span>
                <span class="checkbox-required">Requerido</span>
              </div>
            </div>
            <div class="error-message" *ngIf="hasFieldError('acceptTerms')">
              <i class="fas fa-exclamation-circle mr-2"></i>
              {{ getFieldError("acceptTerms") }}
            </div>
          </div>

          <!-- Marketing Checkbox -->
          <div class="form-group">
            <div
              class="checkbox-label-enhanced"
              (click)="
                onCheckboxChange(
                  'acceptMarketing',
                  !credentials().acceptMarketing
                )
              "
            >
              <input
                type="checkbox"
                [checked]="credentials().acceptMarketing"
                (change)="onCheckboxToggle($event, 'acceptMarketing')"
                style="display: none"
              />
              <span
                class="checkmark-enhanced"
                [class.checked]="credentials().acceptMarketing"
              >
                <i class="fas fa-check"></i>
              </span>
              <div class="checkbox-content">
                <span class="checkbox-text">
                  Quiero recibir consejos espirituales, contenido exclusivo y
                  ofertas especiales por email
                </span>
                <span class="checkbox-optional">Opcional</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Submit Button - MEJORADO CON ICONOS PROFESIONALES -->
        <button
          type="submit"
          class="register-submit-btn mystical-submit-enhanced"
          [disabled]="isLoading()"
          [class.loading]="isLoading()"
        >
          <span class="btn-content" *ngIf="!isLoading()">
            <div class="btn-icon-wrapper">
              <i class="fas fa-star-of-life btn-star-icon"></i>
              <div class="btn-star-glow"></div>
            </div>
            <span class="btn-text">Crear Mi Cuenta</span>
            <div class="btn-arrow-wrapper">
              <i class="fas fa-arrow-right btn-arrow-icon"></i>
              <div class="arrow-trail"></div>
            </div>
          </span>
          <span class="btn-loading" *ngIf="isLoading()">
            <div class="spinner mystical-spinner">
              <div class="spinner-inner"></div>
              <div class="spinner-particles">
                <div class="spinner-particle sp-1"></div>
                <div class="spinner-particle sp-2"></div>
                <div class="spinner-particle sp-3"></div>
              </div>
            </div>
            <span>Creando tu portal místico...</span>
          </span>
        </button>
      </form>

      <!-- Email Verification Section - ICONOS TRANSFORMADOS -->
      <div class="email-verification-section" *ngIf="showEmailVerification()">
        <!-- Verification Header -->
        <div class="verification-header">
          <div class="verification-icon-container">
            <!-- COMPLETAR: HTML mystical envelope -->
            <div class="mystical-envelope-wrapper">
              <i class="fas fa-envelope mystical-envelope-icon"></i>
              <div class="envelope-inner-glow"></div>
              <div class="envelope-outer-glow"></div>
              <div class="envelope-energy-waves">
                <div class="energy-wave wave-1"></div>
                <div class="energy-wave wave-2"></div>
                <div class="energy-wave wave-3"></div>
              </div>
              <div class="envelope-particles">
                <div class="env-particle env-p-1"></div>
                <div class="env-particle env-p-2"></div>
                <div class="env-particle env-p-3"></div>
                <div class="env-particle env-p-4"></div>
              </div>
            </div>

            <!-- COMPLETAR: Sparkle secundario -->
            <div class="verification-sparkle-professional">
              <i class="fas fa-sparkles verification-sparkle-icon"></i>
              <div class="verification-sparkle-trail v-trail-1"></div>
              <div class="verification-sparkle-trail v-trail-2"></div>
            </div>
          </div>

          <!-- CORREGIR: Usar estructura consistente -->
          <div class="verification-title-section">
            <i class="fas fa-check-circle section-icon"></i>
            <h2 class="verification-title">
              <span class="title-highlight">Verifica</span> tu Email
            </h2>
          </div>

          <div class="verification-subtitle-section">
            <i class="fas fa-hashtag section-icon"></i>
            <p class="verification-subtitle">
              Acabamos de enviar un código de <strong>seis dígitos</strong> a tu
              correo electrónico:<br />
              <span class="email-highlight">
                <i class="fas fa-envelope label-icon"></i>
                {{ credentials().email }}
              </span>
            </p>
          </div>

          <div class="verification-instruction-section">
            <i class="fas fa-info-circle section-icon"></i>
            <p class="verification-instruction">
              Ingrésalo aquí para completar tu registro
            </p>
          </div>
        </div>

        <!-- Verification Form -->
        <div class="verification-form">
          <!-- Code Input Container -->
          <div class="code-input-container">
            <div class="code-inputs-grid">
              <input
                type="text"
                maxlength="1"
                class="code-input"
                (input)="onCodeDigitInput($event, 0)"
                (keydown)="onCodeKeyDown($event, 0)"
                (paste)="onCodePaste($event, 0)"
                [attr.data-index]="0"
              />
              <input
                type="text"
                maxlength="1"
                class="code-input"
                (input)="onCodeDigitInput($event, 1)"
                (keydown)="onCodeKeyDown($event, 1)"
                (paste)="onCodePaste($event, 1)"
                [attr.data-index]="1"
              />
              <input
                type="text"
                maxlength="1"
                class="code-input"
                (input)="onCodeDigitInput($event, 2)"
                (keydown)="onCodeKeyDown($event, 2)"
                (paste)="onCodePaste($event, 2)"
                [attr.data-index]="2"
              />
              <input
                type="text"
                maxlength="1"
                class="code-input"
                (input)="onCodeDigitInput($event, 3)"
                (keydown)="onCodeKeyDown($event, 3)"
                (paste)="onCodePaste($event, 3)"
                [attr.data-index]="3"
              />
              <input
                type="text"
                maxlength="1"
                class="code-input"
                (input)="onCodeDigitInput($event, 4)"
                (keydown)="onCodeKeyDown($event, 4)"
                (paste)="onCodePaste($event, 4)"
                [attr.data-index]="4"
              />
              <input
                type="text"
                maxlength="1"
                class="code-input"
                (input)="onCodeDigitInput($event, 5)"
                (keydown)="onCodeKeyDown($event, 5)"
                (paste)="onCodePaste($event, 5)"
                [attr.data-index]="5"
              />
            </div>

            <!-- Hint para el usuario - CON ICONO TRANSFORMADO -->
            <div class="code-input-hint" *ngIf="getFilledDigits() === 0">
              <div class="hint-lightbulb-wrapper-small">
                <i class="fas fa-lightbulb hint-bulb-icon-small"></i>
                <div class="bulb-glow-hint-small"></div>
              </div>
              Tip: Escribe cada dígito y avanzará automáticamente
            </div>

            <!-- Debug temporal -->
            <div
              class="debug-info"
              *ngIf="getFilledDigits() > 0"
              (click)="debugCodeState()"
              style="
                margin-top: 1rem;
                padding: 0.5rem;
                background: rgba(180, 162, 253, 0.1);
                border: 1px solid rgba(180, 162, 253, 0.3);
                border-radius: 0.5rem;
                cursor: pointer;
                font-size: 0.8rem;
                text-align: center;
              "
            ></div>
          </div>

          <!-- Error Message -->
          <div class="verification-error" *ngIf="verificationError()">
            <i class="fas fa-exclamation-triangle mr-2"></i>
            {{ verificationError() }}
          </div>

          <!-- Success Message -->
          <div class="verification-success" *ngIf="verificationSuccess()">
            <i class="fas fa-check-circle mr-2"></i>
            ¡Código verificado! Creando tu cuenta...
          </div>

          <!-- Action Buttons -->
          <div class="verification-actions">
            <button
              type="button"
              class="verify-btn mystical-verify-btn"
              [disabled]="!isCodeComplete() || isVerifying()"
              [class.loading]="isVerifying()"
              (click)="onVerifyCode()"
            >
              <span *ngIf="!isVerifying()">
                <div class="verify-icon-wrapper">
                  <i class="fas fa-shield-check verify-shield-icon"></i>
                  <div class="verify-shield-glow"></div>
                </div>
                Verificar Código
              </span>
              <span *ngIf="isVerifying()">
                <div class="verify-spinner-wrapper">
                  <div class="spinner mystical-verify-spinner">
                    <div class="verify-spinner-inner"></div>
                    <div class="verify-spinner-particles">
                      <div class="verify-spinner-particle vsp-1"></div>
                      <div class="verify-spinner-particle vsp-2"></div>
                      <div class="verify-spinner-particle vsp-3"></div>
                    </div>
                  </div>
                </div>
                Verificando...
              </span>
            </button>

            <div class="resend-section">
              <div class="resend-text-section">
                <i class="fas fa-question-circle section-icon"></i>
                <p class="resend-text">¿No recibiste el código?</p>
              </div>
              <button
                type="button"
                class="resend-btn mystical-resend-btn"
                [disabled]="resendCooldown() > 0 || isResending()"
                (click)="onResendCode()"
              >
                <span *ngIf="!isResending() && resendCooldown() === 0">
                  <div class="resend-icon-wrapper">
                    <i class="fas fa-paper-plane resend-plane-icon"></i>
                    <div class="resend-plane-trail"></div>
                  </div>
                  Reenviar código
                </span>
                <span *ngIf="isResending()">
                  <div class="resend-spinner-wrapper">
                    <div class="spinner resend-spinner">
                      <div class="resend-spinner-inner"></div>
                    </div>
                  </div>
                  Enviando...
                </span>
                <span *ngIf="resendCooldown() > 0">
                  Reenviar en {{ resendCooldown() }}s
                </span>
              </button>
            </div>
          </div>

          <!-- Back to Edit -->
          <div class="back-to-edit">
            <button
              type="button"
              class="back-edit-btn"
              (click)="onBackToEdit()"
            >
              <i class="fas fa-edit mr-2"></i>
              Cambiar email o información
            </button>
          </div>
        </div>
      </div>

      <!-- Divider -->
      <div class="divider" *ngIf="!showEmailVerification()">
        <span class="divider-text">O únete con</span>
      </div>

      <!-- Social Registration -->
      <div class="social-login" *ngIf="!showEmailVerification()">
        <button
          type="button"
          class="social-btn google-btn"
          (click)="onSocialRegister('google')"
          [disabled]="isLoading()"
          aria-label="Registrarse con Google"
        >
          <i class="fab fa-google mr-3" aria-hidden="true"></i>
          <span class="hidden sm:inline">Continuar con Google</span>
          <span class="sm:hidden">Google</span>
        </button>

        <button
          type="button"
          class="social-btn facebook-btn"
          (click)="onSocialRegister('facebook')"
          [disabled]="isLoading()"
          aria-label="Registrarse con Facebook"
        >
          <i class="fab fa-facebook-f mr-3" aria-hidden="true"></i>
          <span class="hidden sm:inline">Continuar con Facebook</span>
          <span class="sm:hidden">Facebook</span>
        </button>
      </div>

      <!-- Login Link -->
      <div class="login-link" *ngIf="!showEmailVerification()">
        <span class="login-text">¿Ya tienes una cuenta?</span>
        <button type="button" class="login-btn group" (click)="onGoToLogin()">
          Iniciar sesión
          <i
            class="fas fa-arrow-right ml-2 transition-transform group-hover:translate-x-1"
            aria-hidden="true"
          ></i>
        </button>
      </div>

      <!-- Trust Indicators -->
      <div
        class="trust-indicators"
        role="contentinfo"
        aria-label="Indicadores de seguridad"
        *ngIf="!showEmailVerification()"
      >
        <div class="trust-item">
          <i class="fas fa-shield-alt" aria-hidden="true"></i>
          <span>100% Seguro</span>
        </div>
        <div class="trust-item">
          <i class="fa-solid fa-wand-magic-sparkles"></i>
          <span>Arcanas Activas</span>
        </div>
        <div class="trust-item">
          <i class="fas fa-times-circle" aria-hidden="true"></i>
          <span>Cancela cuando quieras</span>
        </div>
        <div class="trust-item">
          <i class="fas fa-users" aria-hidden="true"></i>
          <span>+10K miembros</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Screen Reader Only Content -->
  <div class="sr-only" aria-live="polite" aria-atomic="true">
    <span *ngIf="isLoading()">Procesando registro...</span>
    <span *ngIf="calculatedZodiacSign() as zodiacSign"
      >Signo zodiacal calculado: {{ zodiacSign.name }}</span
    >
  </div>
</div>
